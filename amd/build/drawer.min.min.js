define(["jquery","core/custom_interaction_events","core/log"],function(g,f,j){var i={TOGGLE_REGION:'[data-region="drawer-toggle"]',TOGGLE_ACTION:'[data-action="toggle-drawer"]',TOGGLE_TARGET:"aria-controls",TOGGLE_SIDE:"left",BODY:"body"},h=function(){g(i.TOGGLE_REGION).length||j.debug("Page is missing a drawer region"),g(i.TOGGLE_ACTION).length||j.debug("Page is missing a drawer toggle link"),g(i.TOGGLE_REGION).each(function(d,q){var p=g(q).find(i.TOGGLE_ACTION),o=p.attr("aria-controls"),n=g(document.getElementById(o)),m="false"==p.attr("aria-expanded"),l=p.attr("data-side"),k=g(i.BODY);n.on("mousewheel DOMMouseScroll",this.preventPageScroll),m?p.attr("aria-expanded","false"):(k.addClass("drawer-open-"+l),p.attr("aria-expanded","true"))}.bind(this)),this.registerEventListeners();var a=g(document).width()<768;a&&this.closeAll()};return h.prototype.closeAll=function(){g(i.TOGGLE_REGION).each(function(a,p){var o=g(p).find(i.TOGGLE_ACTION),n=o.attr("data-side"),m=g(i.BODY),l=o.attr("aria-controls"),k=g(document.getElementById(l)),d=o.attr("data-preference");o.attr("aria-expanded","false"),m.removeClass("drawer-open-"+n),k.attr("aria-hidden","true"),k.addClass("closed"),M.util.set_user_preference(d,"false")})},h.prototype.toggleDrawer=function(r){var q=g(r.target).closest("[data-action=toggle-drawer]"),p=q.attr("aria-controls"),o=g(document.getElementById(p)),n=g(i.BODY),m=q.attr("data-side"),l=q.attr("data-preference");n.addClass("drawer-ease");var d="true"==q.attr("aria-expanded");if(d){n.removeClass("drawer-open-"+m),q.attr("aria-expanded","false"),o.attr("aria-hidden","true"),o.addClass("closed"),M.util.set_user_preference(l,"false")}else{var a=g(document).width()<768;a&&this.closeAll(),q.attr("aria-expanded","true"),o.attr("aria-hidden","false"),o.focus(),n.addClass("drawer-open-"+m),o.removeClass("closed"),M.util.set_user_preference(l,"true")}},h.prototype.preventPageScroll=function(a){var m=a.wheelDelta||a.originalEvent&&a.originalEvent.wheelDelta||-a.originalEvent.detail,l=this.scrollTop+g(this).outerHeight()-this.scrollHeight>=0,k=this.scrollTop<=0;(m<0&&l||m>0&&k)&&a.preventDefault()},h.prototype.registerEventListeners=function(){g(i.TOGGLE_ACTION).each(function(b,a){f.define(g(a),[f.events.activate]),g(a).on(f.events.activate,function(d,c){this.toggleDrawer(c.originalEvent),c.originalEvent.preventDefault()}.bind(this))}.bind(this))},{init:function(){return new h}}});