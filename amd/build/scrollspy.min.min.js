define(["exports","./util"],function(j,i){function p(b){return b&&b.__esModule?b:{"default":b}}function o(d,c){if(!(d instanceof c)){throw new TypeError("Cannot call a class as a function")}}Object.defineProperty(j,"__esModule",{value:!0});var n=p(i),m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(b){return typeof b}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol?"symbol":typeof b},l=function(){function b(f,e){for(var h=0;h<e.length;h++){var g=e[h];g.enumerable=g.enumerable||!1,g.configurable=!0,"value" in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(a,f,e){return f&&b(a.prototype,f),e&&b(a,e),a}}(),k=function(B){var A="scrollspy",z="4.0.0-alpha.4",y="bs.scrollspy",x="."+y,w=".data-api",v=B.fn[A],u={offset:10,method:"auto",target:""},t={offset:"number",method:"string",target:"(string|element)"},s={ACTIVATE:"activate"+x,SCROLL:"scroll"+x,LOAD_DATA_API:"load"+x+w},g={DROPDOWN_ITEM:"dropdown-item",DROPDOWN_MENU:"dropdown-menu",NAV_LINK:"nav-link",NAV:"nav",ACTIVE:"active"},f={DATA_SPY:'[data-spy="scroll"]',ACTIVE:".active",LIST_ITEM:".list-item",LI:"li",LI_DROPDOWN:"li.dropdown",NAV_LINKS:".nav-link",DROPDOWN:".dropdown",DROPDOWN_ITEMS:".dropdown-item",DROPDOWN_TOGGLE:".dropdown-toggle"},e={OFFSET:"offset",POSITION:"position"},d=function(){function a(h,q){o(this,a),this._element=h,this._scrollElement="BODY"===h.tagName?window:h,this._config=this._getConfig(q),this._selector=this._config.target+" "+f.NAV_LINKS+","+(this._config.target+" "+f.DROPDOWN_ITEMS),this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,B(this._scrollElement).on(s.SCROLL,B.proxy(this._process,this)),this.refresh(),this._process()}return l(a,[{key:"refresh",value:function(){var h=this,D=this._scrollElement!==this._scrollElement.window?e.POSITION:e.OFFSET,C="auto"===this._config.method?D:this._config.method,r=C===e.POSITION?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight();var q=B.makeArray(B(this._selector));q.map(function(E){var G=void 0,F=n["default"].getSelectorFromElement(E);return F&&(G=B(F)[0]),G&&(G.offsetWidth||G.offsetHeight)?[B(G)[C]().top+r,F]:null}).filter(function(b){return b}).sort(function(E,c){return E[0]-c[0]}).forEach(function(b){h._offsets.push(b[0]),h._targets.push(b[1])})}},{key:"dispose",value:function(){B.removeData(this._element,y),B(this._scrollElement).off(x),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null}},{key:"_getConfig",value:function(h){if(h=B.extend({},u,h),"string"!=typeof h.target){var b=B(h.target).attr("id");b||(b=n["default"].getUID(A),B(h.target).attr("id",b)),h.target="#"+b}return n["default"].typeCheckConfig(A,h,t),h}},{key:"_getScrollTop",value:function(){return this._scrollElement===window?this._scrollElement.scrollY:this._scrollElement.scrollTop}},{key:"_getScrollHeight",value:function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}},{key:"_process",value:function(){var q=this._getScrollTop()+this._config.offset,h=this._getScrollHeight(),E=this._config.offset+h-this._scrollElement.offsetHeight;if(this._scrollHeight!==h&&this.refresh(),q>=E){var D=this._targets[this._targets.length-1];this._activeTarget!==D&&this._activate(D)}if(this._activeTarget&&q<this._offsets[0]){return this._activeTarget=null,void this._clear()}for(var C=this._offsets.length;C--;){var r=this._activeTarget!==this._targets[C]&&q>=this._offsets[C]&&(void 0===this._offsets[C+1]||q<this._offsets[C+1]);r&&this._activate(this._targets[C])}}},{key:"_activate",value:function(h){this._activeTarget=h,this._clear();var r=this._selector.split(",");r=r.map(function(b){return b+'[data-target="'+h+'"],'+(b+'[href="'+h+'"]')});var q=B(r.join(","));q.hasClass(g.DROPDOWN_ITEM)?(q.closest(f.DROPDOWN).find(f.DROPDOWN_TOGGLE).addClass(g.ACTIVE),q.addClass(g.ACTIVE)):q.parents(f.LI).find(f.NAV_LINKS).addClass(g.ACTIVE),B(this._scrollElement).trigger(s.ACTIVATE,{relatedTarget:h})}},{key:"_clear",value:function(){B(this._selector).filter(f.ACTIVE).removeClass(g.ACTIVE)}}],[{key:"_jQueryInterface",value:function(c){return this.each(function(){var h=B(this).data(y),b="object"===("undefined"==typeof c?"undefined":m(c))&&c||null;if(h||(h=new a(this,b),B(this).data(y,h)),"string"==typeof c){if(void 0===h[c]){throw new Error('No method named "'+c+'"')}h[c]()}})}},{key:"VERSION",get:function(){return z}},{key:"Default",get:function(){return u}}]),a}();return B(window).on(s.LOAD_DATA_API,function(){for(var a=B.makeArray(B(f.DATA_SPY)),q=a.length;q--;){var h=B(a[q]);d._jQueryInterface.call(h,h.data())}}),B.fn[A]=d._jQueryInterface,B.fn[A].Constructor=d,B.fn[A].noConflict=function(){return B.fn[A]=v,d._jQueryInterface},d}(jQuery);j["default"]=k});