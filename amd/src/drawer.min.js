define(["jquery","core/custom_interaction_events","core/log"],function(e,d,b){var a={TOGGLE_REGION:'[data-region="drawer-toggle"]',TOGGLE_ACTION:'[data-action="toggle-drawer"]',TOGGLE_TARGET:"aria-controls",TOGGLE_SIDE:"left",BODY:"body"};var c=function(){if(!e(a.TOGGLE_REGION).length){b.debug("Page is missing a drawer region")}if(!e(a.TOGGLE_ACTION).length){b.debug("Page is missing a drawer toggle link")}e(a.TOGGLE_REGION).each(function(j,n){var i=e(n).find(a.TOGGLE_ACTION);var h=i.attr("aria-controls");var l=e(document.getElementById(h));var m=i.attr("aria-expanded")=="false";var k=i.attr("data-side");var g=e(a.BODY);l.on("mousewheel DOMMouseScroll",this.preventPageScroll);if(!m){g.addClass("drawer-open-"+k);i.attr("aria-expanded","true")}else{i.attr("aria-expanded","false")}}.bind(this));this.registerEventListeners();var f=e(document).width()<768;if(f){this.closeAll()}};c.prototype.closeAll=function(){e(a.TOGGLE_REGION).each(function(i,m){var h=e(m).find(a.TOGGLE_ACTION);var k=h.attr("data-side");var g=e(a.BODY);var f=h.attr("aria-controls");var l=e(document.getElementById(f));var j=h.attr("data-preference");h.attr("aria-expanded","false");g.removeClass("drawer-open-"+k);l.attr("aria-hidden","true");l.addClass("closed");M.util.set_user_preference(j,"false")})};c.prototype.toggleDrawer=function(l){var f=e(l.target).closest("[data-action=toggle-drawer]");var n=f.attr("aria-controls");var g=e(document.getElementById(n));var k=e(a.BODY);var m=f.attr("data-side");var i=f.attr("data-preference");k.addClass("drawer-ease");var j=f.attr("aria-expanded")=="true";if(!j){var h=e(document).width()<768;if(h){this.closeAll()}f.attr("aria-expanded","true");g.attr("aria-hidden","false");g.focus();k.addClass("drawer-open-"+m);g.removeClass("closed");M.util.set_user_preference(i,"true")}else{k.removeClass("drawer-open-"+m);f.attr("aria-expanded","false");g.attr("aria-hidden","true");g.addClass("closed");M.util.set_user_preference(i,"false")}};c.prototype.preventPageScroll=function(h){var i=h.wheelDelta||(h.originalEvent&&h.originalEvent.wheelDelta)||-h.originalEvent.detail,g=(this.scrollTop+e(this).outerHeight()-this.scrollHeight)>=0,f=this.scrollTop<=0;if((i<0&&g)||(i>0&&f)){h.preventDefault()}};c.prototype.registerEventListeners=function(){e(a.TOGGLE_ACTION).each(function(f,g){d.define(e(g),[d.events.activate]);e(g).on(d.events.activate,function(i,h){this.toggleDrawer(h.originalEvent);h.originalEvent.preventDefault()}.bind(this))}.bind(this))};return{init:function(){return new c()}}});